\ProvidesPackage{oleks}

\RequirePackage{graphicx}
\RequirePackage{xparse}
\RequirePackage{xstring}
\RequirePackage{ifthen}
\RequirePackage[table]{xcolor}

% figures

\NewDocumentCommand\includeFigure{O{1}mmO{htbp!}}
{
	\begin{figure}[#4]
	\centering
	\IfDecimal{#1}
	{	
		\includegraphics[scale=#1]{figures/#2}
	}
	{
		\includegraphics[#1]{figures/#2}
	}
	\caption[]{#3}
	\label{figure:#2}
	\end{figure}
}

% references

\NewDocumentCommand\referToSection{m}
{
	\textsection\ref{section:#1}/\pageref{section:#1}
}

\NewDocumentCommand\referToFigure{m}
{
	Figure \ref{figure:#1}/\pageref{figure:#1}
}

\NewDocumentCommand\referToTable{m}
{
	Table \textsection\ref{table:#1}/\pageref{table:#1}
}

% sections

%% allow to pick the sort of section by specifying a toc depth

\NewDocumentCommand\startSectionAux{O{\empty}O{section}mm}
{
	\lowercase{
		\ifthenelse{\equal{#1}{\empty}}
		{\def\templabel{#3}}
		{\def\templabel{#1}}
	}

	\StrSubstitute{\templabel}{ }{-}[\templabel]
	\StrSubstitute{\templabel}{,}{}[\templabel]
	\StrSubstitute{\templabel}{'}{}[\templabel]

	\csname#4\endcsname{#3}\label{#2:\templabel}
}

\NewDocumentCommand\startSection{O{1}mO{\empty}}
{
	\ifthenelse{\equal{#1}{2}}
	{\startSectionAux[#3]{#2}{subsection}}
	{\ifthenelse{\equal{#1}{3}}
	{\startSectionAux[#3]{#2}{subsubsection}}
	{\startSectionAux[#3]{#2}{section}}
	}
}


% tables

\definecolor{tableShade}{RGB}{245,245,245}

\NewDocumentCommand\makeTable{O{t!}mmmmm}
{
	\begin{table}[#1]
	\centering
	\rowcolors{2}{tableShade}{white}
	\begin{tabular}{#4}
	\hline
	#5\\
	\hline
	#6\\
	\end{tabular}
	\caption[]{#3}
	\label{table:#2}
	\end{table}
}
